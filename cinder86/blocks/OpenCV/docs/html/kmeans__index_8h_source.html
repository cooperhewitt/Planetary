<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Cinder</title>
		<link rel="stylesheet" href="cinder_doxygen.css" type="text/css" media="screen" />
	</head>
<body>	
<div class="wrapper">
	<div id="header">
		<h1><a href="http://libcinder.org">Cinder</a></h1>
	</div>
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_2b499c8a2c25fbeb8b417f4ad28f62b8.html">opencv2</a></li><li class="navelem"><a class="el" href="dir_e085d1311579a14d1ff03783f4c504c6.html">flann</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">kmeans_index.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="kmeans__index_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/***********************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Software License Agreement (BSD License)</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright 2008-2009  Marius Muja (mariusm@cs.ubc.ca). All rights reserved.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Copyright 2008-2009  David G. Lowe (lowe@cs.ubc.ca). All rights reserved.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * THE BSD LICENSE</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * modification, are permitted provided that the following conditions</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * are met:</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * 1. Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *    notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *    documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS&#39;&#39; AND ANY EXPRESS OR</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *************************************************************************/</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifndef OPENCV_FLANN_KMEANS_INDEX_H_</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#define OPENCV_FLANN_KMEANS_INDEX_H_</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="general_8h.html">general.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nn__index_8h.html">nn_index.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dist_8h.html">dist.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;matrix.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="result__set_8h.html">result_set.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="heap_8h.html">heap.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="allocator_8h.html">allocator.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="random_8h.html">random.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="saving_8h.html">saving.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="logger_8h.html">logger.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span>cvflann</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structcvflann_1_1_k_means_index_params.html">   56</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcvflann_1_1_k_means_index_params.html">KMeansIndexParams</a> : <span class="keyword">public</span> <a class="code" href="namespacecvflann.html#a742b4c7076c21012054af74a9ee48289">IndexParams</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structcvflann_1_1_k_means_index_params.html#a90583aa43cad96f6c7cecb3febe8213b">   58</a></span>&#160;    <a class="code" href="structcvflann_1_1_k_means_index_params.html#a90583aa43cad96f6c7cecb3febe8213b">KMeansIndexParams</a>(<span class="keywordtype">int</span> branching = 32, <span class="keywordtype">int</span> <a class="code" href="tracking_8hpp.html#a17372ac3c8ba01bc6cfc265b2824992e">iterations</a> = 11,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                      <a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703">flann_centers_init_t</a> centers_init = <a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a2cec6d6a56fac53c140b2f8f28a14aef">FLANN_CENTERS_RANDOM</a>, <span class="keywordtype">float</span> cb_index = 0.2 )</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        (*this)[<span class="stringliteral">&quot;algorithm&quot;</span>] = <a class="code" href="namespacecvflann.html#a4e3e6c98d774ea77fd7f0045c9bc7817a8f59fc67e6deef84edfaf55506bb8466">FLANN_INDEX_KMEANS</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// branching factor</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        (*this)[<span class="stringliteral">&quot;branching&quot;</span>] = branching;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment">// max iterations to perform in one kmeans clustering (kmeans tree)</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        (*this)[<span class="stringliteral">&quot;iterations&quot;</span>] = <a class="code" href="tracking_8hpp.html#a17372ac3c8ba01bc6cfc265b2824992e">iterations</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// algorithm used for picking the initial cluster centers for kmeans tree</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        (*this)[<span class="stringliteral">&quot;centers_init&quot;</span>] = centers_init;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// cluster boundary index. Used when searching the kmeans tree</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        (*this)[<span class="stringliteral">&quot;cb_index&quot;</span>] = cb_index;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;};</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Distance&gt;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html">   81</a></span>&#160;<span class="keyword">class </span><a class="code" href="classcvflann_1_1_k_means_index.html">KMeansIndex</a> : <span class="keyword">public</span> <a class="code" href="classcvflann_1_1_n_n_index.html">NNIndex</a>&lt;Distance&gt;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">   84</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> Distance::ElementType <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">   85</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> Distance::ResultType <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a09b9ff9e5a1686adc4a5e6cc8a765768">   89</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="highgui__c_8h.html#ad1f9461adaad33556b3a01c7f2c6ceab">void</a> (<a class="code" href="classcvflann_1_1_k_means_index.html">KMeansIndex</a>::* <a class="code" href="classcvflann_1_1_k_means_index.html#a09b9ff9e5a1686adc4a5e6cc8a765768">centersAlgFunction</a>)(<a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>, <span class="keywordtype">int</span>*, <a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>, <span class="keywordtype">int</span>*, <span class="keywordtype">int</span>&amp;);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">   94</a></span>&#160;    <a class="code" href="classcvflann_1_1_k_means_index.html#a09b9ff9e5a1686adc4a5e6cc8a765768">centersAlgFunction</a> <a class="code" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">chooseCenters</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a2dd49d64f6cdc7751990ee1f1920609e">  108</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2dd49d64f6cdc7751990ee1f1920609e">chooseCentersRandom</a>(<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>, <span class="keywordtype">int</span>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#adbd1b09d60fa0a569e6873aa161d44c7">indices</a>, <span class="keywordtype">int</span> indices_length, <span class="keywordtype">int</span>* centers, <span class="keywordtype">int</span>&amp; centers_length)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="classcvflann_1_1_unique_random.html">UniqueRandom</a> <a class="code" href="core__c_8h.html#a54709f3b06b33b66763f1613cc7fb571">r</a>(indices_length);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">for</span> (index=0; index&lt;<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>; ++<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordtype">bool</span> duplicate = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordtype">int</span> rnd;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">while</span> (duplicate) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                duplicate = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                rnd = r.<a class="code" href="classcvflann_1_1_unique_random.html#a95eb32308d0a5a2d99a03fe23d809c1f">next</a>();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">if</span> (rnd&lt;0) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    centers_length = <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                centers[<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>] = indices[rnd];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>; ++j) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> sq = distance_(dataset_[centers[index]], dataset_[centers[j]], dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <span class="keywordflow">if</span> (sq&lt;1e-16) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        duplicate = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        centers_length = <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a224fbbe5fdc60db9374ddbf499b0e9d3">  149</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a224fbbe5fdc60db9374ddbf499b0e9d3">chooseCentersGonzales</a>(<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>, <span class="keywordtype">int</span>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#adbd1b09d60fa0a569e6873aa161d44c7">indices</a>, <span class="keywordtype">int</span> indices_length, <span class="keywordtype">int</span>* centers, <span class="keywordtype">int</span>&amp; centers_length)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a830e6eb5d1b77f7226a78592ba9d2613">n</a> = indices_length;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordtype">int</span> rnd = <a class="code" href="namespacecvflann.html#a95bce8b3d90ee54a8a4454bdc74ead3b">rand_int</a>(n);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        assert(rnd &gt;=0 &amp;&amp; rnd &lt; n);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        centers[0] = indices[rnd];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">for</span> (index=1; index&lt;<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>; ++<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordtype">int</span> best_index = -1;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> best_val = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; ++j) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a> = distance_(dataset_[centers[0]],dataset_[indices[j]],dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>; ++i) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> tmp_dist = distance_(dataset_[centers[i]],dataset_[indices[j]],dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    <span class="keywordflow">if</span> (tmp_dist&lt;dist) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        dist = tmp_dist;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">if</span> (dist&gt;best_val) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    best_val = <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    best_index = j;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">if</span> (best_index!=-1) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                centers[<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>] = indices[best_index];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        centers_length = <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a02bf5e31ac3996251fea5e2de6bd3fea">  200</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a02bf5e31ac3996251fea5e2de6bd3fea">chooseCentersKMeanspp</a>(<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>, <span class="keywordtype">int</span>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#adbd1b09d60fa0a569e6873aa161d44c7">indices</a>, <span class="keywordtype">int</span> indices_length, <span class="keywordtype">int</span>* centers, <span class="keywordtype">int</span>&amp; centers_length)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a830e6eb5d1b77f7226a78592ba9d2613">n</a> = indices_length;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordtype">double</span> currentPot = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* closestDistSq = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[<a class="code" href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// Choose one random center and set the closestDistSq values</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a> = <a class="code" href="namespacecvflann.html#a95bce8b3d90ee54a8a4454bdc74ead3b">rand_int</a>(n);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        assert(index &gt;=0 &amp;&amp; index &lt; n);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        centers[0] = indices[<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            closestDistSq[i] = distance_(dataset_[indices[i]], dataset_[indices[index]], dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            currentPot += closestDistSq[i];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> numLocalTries = 1;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">// Choose each center</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordtype">int</span> centerCount;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">for</span> (centerCount = 1; centerCount &lt; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>; centerCount++) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="comment">// Repeat several trials</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordtype">double</span> bestNewPot = -1;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordtype">int</span> bestNewIndex = -1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> localTrial = 0; localTrial &lt; numLocalTries; localTrial++) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="comment">// Choose our center - have to be slightly careful to return a valid answer even accounting</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="comment">// for possible rounding errors</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordtype">double</span> randVal = <a class="code" href="namespacecvflann.html#aa67f0a9c42ad900e10dfd3cf0f1e4355">rand_double</a>(currentPot);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">for</span> (index = 0; index &lt; n-1; index++) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keywordflow">if</span> (randVal &lt;= closestDistSq[index]) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    <span class="keywordflow">else</span> randVal -= closestDistSq[<a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="comment">// Compute the new potential</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordtype">double</span> newPot = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++) newPot += <a class="code" href="namespacecv.html#ab95fdcad3fb0246321e2af231d24d5a9">std::min</a>( distance_(dataset_[indices[i]], dataset_[indices[index]], dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>), closestDistSq[i] );</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="comment">// Store the best result</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">if</span> ((bestNewPot &lt; 0)||(newPot &lt; bestNewPot)) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    bestNewPot = newPot;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    bestNewIndex = <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// Add the appropriate center</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            centers[centerCount] = indices[bestNewIndex];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            currentPot = bestNewPot;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>; i++) closestDistSq[i] = <a class="code" href="namespacecv.html#ab95fdcad3fb0246321e2af231d24d5a9">std::min</a>( distance_(dataset_[indices[i]], dataset_[indices[bestNewIndex]], dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>), closestDistSq[i] );</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        centers_length = centerCount;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">delete</span>[] closestDistSq;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#ab1d2d857e2ee7660d24e563c4c11dab1">  263</a></span>&#160;    <a class="code" href="namespacecvflann.html#a4e3e6c98d774ea77fd7f0045c9bc7817">flann_algorithm_t</a> <a class="code" href="classcvflann_1_1_k_means_index.html#ab1d2d857e2ee7660d24e563c4c11dab1">getType</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacecvflann.html#a4e3e6c98d774ea77fd7f0045c9bc7817a8f59fc67e6deef84edfaf55506bb8466">FLANN_INDEX_KMEANS</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#ae4bea160d9e9d70f0f8177be8e0d1f0e">  275</a></span>&#160;    <a class="code" href="classcvflann_1_1_k_means_index.html#ae4bea160d9e9d70f0f8177be8e0d1f0e">KMeansIndex</a>(<span class="keyword">const</span> <a class="code" href="classcvflann_1_1_matrix.html">Matrix&lt;ElementType&gt;</a>&amp; inputData, <span class="keyword">const</span> <a class="code" href="namespacecvflann.html#a742b4c7076c21012054af74a9ee48289">IndexParams</a>&amp; <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a> = <a class="code" href="structcvflann_1_1_k_means_index_params.html">KMeansIndexParams</a>(),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                Distance <a class="code" href="legacy_8hpp.html#a6f364afbe132c4ecfea48bde1b0618ba">d</a> = Distance())</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        : dataset_(inputData), index_params_(<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a>), root_(NULL), indices_(NULL), distance_(<a class="code" href="legacy_8hpp.html#a6f364afbe132c4ecfea48bde1b0618ba">d</a>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        memoryCounter_ = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        size_ = dataset_.<a class="code" href="classcvflann_1_1_matrix.html#aff6ee6abf050b1848fca59654c5669bc">rows</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        veclen_ = dataset_.<a class="code" href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cols</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        branching_ = <a class="code" href="namespacecvflann.html#a6ea20e8aad20212544cb42368c1e5b5f">get_param</a>(<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a>,<span class="stringliteral">&quot;branching&quot;</span>,32);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        iterations_ = <a class="code" href="namespacecvflann.html#a6ea20e8aad20212544cb42368c1e5b5f">get_param</a>(<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a>,<span class="stringliteral">&quot;iterations&quot;</span>,11);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">if</span> (iterations_&lt;0) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            iterations_ = (std::numeric_limits&lt;int&gt;::max)();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        centers_init_  = <a class="code" href="namespacecvflann.html#a6ea20e8aad20212544cb42368c1e5b5f">get_param</a>(<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a>,<span class="stringliteral">&quot;centers_init&quot;</span>,<a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a2cec6d6a56fac53c140b2f8f28a14aef">FLANN_CENTERS_RANDOM</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">if</span> (centers_init_==<a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a2cec6d6a56fac53c140b2f8f28a14aef">FLANN_CENTERS_RANDOM</a>) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">chooseCenters</a> = &amp;<a class="code" href="classcvflann_1_1_k_means_index.html#a2dd49d64f6cdc7751990ee1f1920609e">KMeansIndex::chooseCentersRandom</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (centers_init_==<a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a8f42551d6005b25200e6e239d7e1f036">FLANN_CENTERS_GONZALES</a>) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">chooseCenters</a> = &amp;<a class="code" href="classcvflann_1_1_k_means_index.html#a224fbbe5fdc60db9374ddbf499b0e9d3">KMeansIndex::chooseCentersGonzales</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (centers_init_==<a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a99f2e3471f856cda026b4d922275e60b">FLANN_CENTERS_KMEANSPP</a>) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">chooseCenters</a> = &amp;<a class="code" href="classcvflann_1_1_k_means_index.html#a02bf5e31ac3996251fea5e2de6bd3fea">KMeansIndex::chooseCentersKMeanspp</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcvflann_1_1_f_l_a_n_n_exception.html">FLANNException</a>(<span class="stringliteral">&quot;Unknown algorithm for choosing initial centers.&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        cb_index_ = 0.4f;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classcvflann_1_1_k_means_index.html#ae4bea160d9e9d70f0f8177be8e0d1f0e">KMeansIndex</a>(<span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html">KMeansIndex</a>&amp;);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classcvflann_1_1_k_means_index.html">KMeansIndex</a>&amp; <a class="code" href="classcvflann_1_1_k_means_index.html#a8d2472fca09e17b351ed52b90e0d3b25">operator=</a>(<span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html">KMeansIndex</a>&amp;);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a8aba38be2d90c7dd22eaa710e19ceb83">  317</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a8aba38be2d90c7dd22eaa710e19ceb83">~KMeansIndex</a>()</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">if</span> (root_ != NULL) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            free_centers(root_);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (indices_!=NULL) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keyword">delete</span>[] indices_;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#accb5cd8cd1aec9b55420471537ee6423">  330</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classcvflann_1_1_k_means_index.html#accb5cd8cd1aec9b55420471537ee6423">size</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">return</span> size_;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#ad3c60e35d2f9face152ef9a8a303493a">  338</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classcvflann_1_1_k_means_index.html#ad3c60e35d2f9face152ef9a8a303493a">veclen</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">return</span> veclen_;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#ac65e5ca1bc0c0e1a4663438eff141861">  344</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#ac65e5ca1bc0c0e1a4663438eff141861">set_cb_index</a>( <span class="keywordtype">float</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        cb_index_ = <a class="code" href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a95475eb6c639b87fa5e07812d6f4058a">  353</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a95475eb6c639b87fa5e07812d6f4058a">usedMemory</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span> pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#a6e5510ec11212e0bb1b109b3af09e172">usedMemory</a>+pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#af69edd6191138a563f9205d1db7bdd18">wastedMemory</a>+memoryCounter_;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a8018b120cc79371b02e58b50f8992634">  361</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a8018b120cc79371b02e58b50f8992634">buildIndex</a>()</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">if</span> (branching_&lt;2) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcvflann_1_1_f_l_a_n_n_exception.html">FLANNException</a>(<span class="stringliteral">&quot;Branching factor must be at least 2&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        indices_ = <span class="keyword">new</span> <span class="keywordtype">int</span>[size_];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;size_; ++i) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            indices_[i] = <a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>(i);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        root_ = pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">allocate</a>&lt;KMeansNode&gt;();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        computeNodeStatistics(root_, indices_, (<span class="keywordtype">int</span>)size_);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        computeClustering(root_, indices_, (<span class="keywordtype">int</span>)size_, branching_,0);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a4c388bc8fab9af7ec567e00366ea14f6">  378</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a4c388bc8fab9af7ec567e00366ea14f6">saveIndex</a>(FILE* stream)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, branching_);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, iterations_);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, memoryCounter_);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, cb_index_);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, *indices_, (<span class="keywordtype">int</span>)size_);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        save_tree(stream, root_);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a11e0ff42576490042f640c2c382999d0">  390</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a11e0ff42576490042f640c2c382999d0">loadIndex</a>(FILE* stream)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, branching_);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, iterations_);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, memoryCounter_);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, cb_index_);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> (indices_!=NULL) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keyword">delete</span>[] indices_;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        indices_ = <span class="keyword">new</span> <span class="keywordtype">int</span>[size_];</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, *indices_, size_);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> (root_!=NULL) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            free_centers(root_);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        load_tree(stream, root_);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        index_params_[<span class="stringliteral">&quot;algorithm&quot;</span>] = <a class="code" href="classcvflann_1_1_k_means_index.html#ab1d2d857e2ee7660d24e563c4c11dab1">getType</a>();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        index_params_[<span class="stringliteral">&quot;branching&quot;</span>] = branching_;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        index_params_[<span class="stringliteral">&quot;iterations&quot;</span>] = iterations_;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        index_params_[<span class="stringliteral">&quot;centers_init&quot;</span>] = centers_init_;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        index_params_[<span class="stringliteral">&quot;cb_index&quot;</span>] = cb_index_;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a2e666baa48e5094e755c0ccdeb908b55">  425</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2e666baa48e5094e755c0ccdeb908b55">findNeighbors</a>(<a class="code" href="classcvflann_1_1_result_set.html">ResultSet&lt;DistanceType&gt;</a>&amp; <a class="code" href="core__c_8h.html#a14871c176a686a03035b5f2bbc72a63f">result</a>, <span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec, <span class="keyword">const</span> <a class="code" href="structcvflann_1_1_search_params.html">SearchParams</a>&amp; searchParams)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">int</span> maxChecks = <a class="code" href="namespacecvflann.html#a6ea20e8aad20212544cb42368c1e5b5f">get_param</a>(searchParams,<span class="stringliteral">&quot;checks&quot;</span>,32);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (maxChecks==<a class="code" href="namespacecvflann.html#a07490d20628e87c4c1cc7438d22b0b32a117f0363bf05d8ee327d795e0ff1d174">FLANN_CHECKS_UNLIMITED</a>) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            findExactNN(root_, result, vec);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="comment">// Priority queue storing intermediate branches in the best-bin-first search</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <a class="code" href="classcvflann_1_1_heap.html">Heap&lt;BranchSt&gt;</a>* heap = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_heap.html">Heap&lt;BranchSt&gt;</a>((<a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>)size_);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordtype">int</span> checks = 0;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            findNN(root_, result, vec, checks, maxChecks, heap);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <a class="code" href="structcvflann_1_1_branch_struct.html">BranchSt</a> branch;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">while</span> (heap-&gt;<a class="code" href="classcvflann_1_1_heap.html#a6c6d2fd6b7522e13049389ab4ae0e0ab">popMin</a>(branch) &amp;&amp; (checks&lt;maxChecks || !result.<a class="code" href="classcvflann_1_1_result_set.html#a8e29e42b9f3eb9c636f19927f46c8db4">full</a>())) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                KMeansNodePtr <a class="code" href="core__c_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a> = branch.<a class="code" href="structcvflann_1_1_branch_struct.html#aec910979d940fef80651b196a294ad70">node</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                findNN(node, result, vec, checks, maxChecks, heap);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            assert(result.<a class="code" href="classcvflann_1_1_result_set.html#a8e29e42b9f3eb9c636f19927f46c8db4">full</a>());</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keyword">delete</span> heap;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a773a603be17320c0d106662548407336">  459</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a773a603be17320c0d106662548407336">getClusterCenters</a>(<a class="code" href="classcvflann_1_1_matrix.html">Matrix&lt;DistanceType&gt;</a>&amp; centers)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordtype">int</span> numClusters = centers.<a class="code" href="classcvflann_1_1_matrix.html#aff6ee6abf050b1848fca59654c5669bc">rows</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (numClusters&lt;1) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcvflann_1_1_f_l_a_n_n_exception.html">FLANNException</a>(<span class="stringliteral">&quot;Number of clusters must be at least 1&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> variance;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        KMeansNodePtr* clusters = <span class="keyword">new</span> KMeansNodePtr[numClusters];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordtype">int</span> clusterCount = getMinVarianceClusters(root_, clusters, numClusters, variance);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        Logger::info(<span class="stringliteral">&quot;Clusters requested: %d, returning %d\n&quot;</span>,numClusters, clusterCount);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;clusterCount; ++i) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* <a class="code" href="core__c_8h.html#a3f007d4bba0b0e0a4cbcb681f97f241c">center</a> = clusters[i]-&gt;pivot;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;veclen_; ++j) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                centers[i][j] = center[j];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keyword">delete</span>[] clusters;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">return</span> clusterCount;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classcvflann_1_1_k_means_index.html#a1e51703a5f49deda70a3eb1ce755ce45">  484</a></span>&#160;    <a class="code" href="namespacecvflann.html#a742b4c7076c21012054af74a9ee48289">IndexParams</a> <a class="code" href="classcvflann_1_1_k_means_index.html#a1e51703a5f49deda70a3eb1ce755ce45">getParameters</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">return</span> index_params_;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">struct </span>KMeansNode</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* pivot;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="core__c_8h.html#a7bea932e1cd0c79d103a7870a1921a4e">radius</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> mean_radius;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> variance;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classcvflann_1_1_k_means_index.html#accb5cd8cd1aec9b55420471537ee6423">size</a>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        KMeansNode** childs;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordtype">int</span>* <a class="code" href="legacy_8hpp.html#a51ee427d6109367fc5bc252655997324">indices</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#af2af72053e0d7a7150c50c993d1cb2b3">level</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    };</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">typedef</span> KMeansNode* KMeansNodePtr;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keyword">typedef</span> BranchStruct&lt;KMeansNodePtr, DistanceType&gt; BranchSt;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">void</span> save_tree(FILE* stream, KMeansNodePtr <a class="code" href="core__c_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a>)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, *node);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, *(node-&gt;pivot), (<span class="keywordtype">int</span>)veclen_);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span> (node-&gt;childs==NULL) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordtype">int</span> indices_offset = (<a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>)(node-&gt;indices - indices_);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <a class="code" href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">save_value</a>(stream, indices_offset);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                save_tree(stream, node-&gt;childs[i]);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">void</span> load_tree(FILE* stream, KMeansNodePtr&amp; node)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        node = pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">allocate</a>&lt;KMeansNode&gt;();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, *node);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        node-&gt;pivot = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[veclen_];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, *(node-&gt;pivot), (<span class="keywordtype">int</span>)veclen_);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">if</span> (node-&gt;childs==NULL) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordtype">int</span> indices_offset;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <a class="code" href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">load_value</a>(stream, indices_offset);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            node-&gt;indices = indices_ + indices_offset;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            node-&gt;childs = pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">allocate</a>&lt;KMeansNodePtr&gt;(branching_);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                load_tree(stream, node-&gt;childs[i]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">void</span> free_centers(KMeansNodePtr node)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keyword">delete</span>[] node-&gt;pivot;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> (node-&gt;childs!=NULL) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;branching_; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                free_centers(node-&gt;childs[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>]);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">void</span> computeNodeStatistics(KMeansNodePtr node, <span class="keywordtype">int</span>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#adbd1b09d60fa0a569e6873aa161d44c7">indices</a>, <span class="keywordtype">int</span> indices_length)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="core__c_8h.html#a7bea932e1cd0c79d103a7870a1921a4e">radius</a> = 0;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> variance = 0;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* <a class="code" href="core__c_8h.html#ad090d0faa53f44e0377c8d63dab3fa20">mean</a> = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[veclen_];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        memoryCounter_ += <a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>(veclen_*<span class="keyword">sizeof</span>(<a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>));</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        memset(mean,0,veclen_*<span class="keyword">sizeof</span>(<a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;size_; ++i) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec = dataset_[indices[i]];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;veclen_; ++j) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                mean[j] += vec[j];</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            variance += distance_(vec, ZeroIterator&lt;ElementType&gt;(), veclen_);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;veclen_; ++j) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            mean[j] /= size_;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        variance /= size_;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        variance -= distance_(mean, ZeroIterator&lt;ElementType&gt;(), veclen_);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> tmp = 0;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;indices_length; ++i) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            tmp = distance_(mean, dataset_[indices[i]], veclen_);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">if</span> (tmp&gt;radius) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                radius = tmp;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        node-&gt;variance = variance;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        node-&gt;radius = <a class="code" href="core__c_8h.html#a7bea932e1cd0c79d103a7870a1921a4e">radius</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        node-&gt;pivot = <a class="code" href="core__c_8h.html#ad090d0faa53f44e0377c8d63dab3fa20">mean</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">void</span> computeClustering(KMeansNodePtr node, <span class="keywordtype">int</span>* indices, <span class="keywordtype">int</span> indices_length, <span class="keywordtype">int</span> branching, <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#abc60a79088789bd61297bf5f9ff500d1">level</a>)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        node-&gt;size = indices_length;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        node-&gt;level = <a class="code" href="legacy_8hpp.html#af2af72053e0d7a7150c50c993d1cb2b3">level</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">if</span> (indices_length &lt; branching) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            node-&gt;indices = <a class="code" href="legacy_8hpp.html#a51ee427d6109367fc5bc252655997324">indices</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <a class="code" href="namespacecv.html#aad9b72b24146c673236033a113c9ed41">std::sort</a>(node-&gt;indices,node-&gt;indices+indices_length);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            node-&gt;childs = NULL;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordtype">int</span>* centers_idx = <span class="keyword">new</span> <span class="keywordtype">int</span>[branching];</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordtype">int</span> centers_length;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        (this-&gt;*<a class="code" href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">chooseCenters</a>)(branching, indices, indices_length, centers_idx, centers_length);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (centers_length&lt;branching) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            node-&gt;indices = <a class="code" href="legacy_8hpp.html#a51ee427d6109367fc5bc252655997324">indices</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <a class="code" href="namespacecv.html#aad9b72b24146c673236033a113c9ed41">std::sort</a>(node-&gt;indices,node-&gt;indices+indices_length);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            node-&gt;childs = NULL;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keyword">delete</span> [] centers_idx;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        Matrix&lt;double&gt; dcenters(<span class="keyword">new</span> <span class="keywordtype">double</span>[branching*veclen_],branching,veclen_);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;centers_length; ++i) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec = dataset_[centers_idx[i]];</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;veclen_; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                dcenters[i][<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] = <a class="code" href="namespacecv_1_1gpu_1_1device.html#ac2a9c7bbc0733fc5db3e91e189bc16f6">double</a>(vec[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>]);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keyword">delete</span>[] centers_idx;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        std::vector&lt;DistanceType&gt; radiuses(branching);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordtype">int</span>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a9274fa62feb8371797c4c0312446e333">count</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[branching];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching; ++i) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            radiuses[i] = 0;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            count[i] = 0;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="comment">//  assign points to clusters</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordtype">int</span>* belongs_to = <span class="keyword">new</span> <span class="keywordtype">int</span>[indices_length];</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;indices_length; ++i) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> sq_dist = distance_(dataset_[indices[i]], dcenters[0], veclen_);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            belongs_to[i] = 0;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;branching; ++j) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> new_sq_dist = distance_(dataset_[indices[i]], dcenters[j], veclen_);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <span class="keywordflow">if</span> (sq_dist&gt;new_sq_dist) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    belongs_to[i] = j;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    sq_dist = new_sq_dist;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">if</span> (sq_dist&gt;radiuses[belongs_to[i]]) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                radiuses[belongs_to[i]] = sq_dist;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            count[belongs_to[i]]++;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordtype">bool</span> converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordtype">int</span> iteration = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">while</span> (!converged &amp;&amp; iteration&lt;iterations_) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            converged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            iteration++;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="comment">// compute the new cluster centers</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching; ++i) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                memset(dcenters[i],0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*veclen_);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                radiuses[i] = 0;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;indices_length; ++i) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec = dataset_[indices[i]];</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordtype">double</span>* <a class="code" href="core__c_8h.html#a3f007d4bba0b0e0a4cbcb681f97f241c">center</a> = dcenters[belongs_to[i]];</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;veclen_; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    center[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] += vec[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>];</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching; ++i) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="keywordtype">int</span> cnt = count[i];</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;veclen_; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    dcenters[i][<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] /= cnt;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment">// reassign points to clusters</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;indices_length; ++i) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> sq_dist = distance_(dataset_[indices[i]], dcenters[0], veclen_);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordtype">int</span> new_centroid = 0;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;branching; ++j) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> new_sq_dist = distance_(dataset_[indices[i]], dcenters[j], veclen_);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    <span class="keywordflow">if</span> (sq_dist&gt;new_sq_dist) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        new_centroid = j;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        sq_dist = new_sq_dist;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="keywordflow">if</span> (sq_dist&gt;radiuses[new_centroid]) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    radiuses[new_centroid] = sq_dist;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="keywordflow">if</span> (new_centroid != belongs_to[i]) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    count[belongs_to[i]]--;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    count[new_centroid]++;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    belongs_to[i] = new_centroid;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching; ++i) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="comment">// if one cluster converges to an empty cluster,</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="comment">// move an element into that cluster</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">if</span> (count[i]==0) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="keywordtype">int</span> j = (i+1)%branching;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    <span class="keywordflow">while</span> (count[j]&lt;=1) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                        j = (j+1)%branching;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;indices_length; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                        <span class="keywordflow">if</span> (belongs_to[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>]==j) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                            <span class="comment">// for cluster j, we move the furthest element from the center to the empty cluster i</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                            <span class="keywordflow">if</span> ( distance_(dataset_[indices[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>]], dcenters[j], veclen_) == radiuses[j] ) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                belongs_to[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] = i;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                count[j]--;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                count[i]++;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                            }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                        }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>** centers = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>*[branching];</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching; ++i) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            centers[i] = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[veclen_];</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            memoryCounter_ += (<a class="code" href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">int</a>)(veclen_*<span class="keyword">sizeof</span>(<a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>));</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=0; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&lt;veclen_; ++<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                centers[i][<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] = (<a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>)dcenters[i][<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>];</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="comment">// compute kmeans clustering for each of the resulting clusters</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        node-&gt;childs = pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">allocate</a>&lt;KMeansNodePtr&gt;(branching);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a13be19455586e95d5a42ed8f054afad2">start</a> = 0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a432111147038972f06e049e18a837002">end</a> = <a class="code" href="core__c_8h.html#a45314566a84a31f43e6435d1eb24d4ec">start</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>=0; <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>&lt;branching; ++<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> = count[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>];</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> variance = 0;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> mean_radius =0;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;indices_length; ++i) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="keywordflow">if</span> (belongs_to[i]==<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="legacy_8hpp.html#a6f364afbe132c4ecfea48bde1b0618ba">d</a> = distance_(dataset_[indices[i]], ZeroIterator&lt;ElementType&gt;(), veclen_);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    variance += <a class="code" href="legacy_8hpp.html#a6f364afbe132c4ecfea48bde1b0618ba">d</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    mean_radius += <a class="code" href="namespacecv.html#a2ae54521731aa4bcf7bc5042a2db88bb">sqrt</a>(d);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <a class="code" href="namespacecv.html#aee66fd35ceb08e5e93177b123481a25e">std::swap</a>(indices[i],indices[end]);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    <a class="code" href="namespacecv.html#aee66fd35ceb08e5e93177b123481a25e">std::swap</a>(belongs_to[i],belongs_to[end]);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    end++;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            variance /= s;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            mean_radius /= s;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            variance -= distance_(centers[<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>], ZeroIterator&lt;ElementType&gt;(), veclen_);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>] = pool_.<a class="code" href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">allocate</a>&lt;KMeansNode&gt;();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>]-&gt;radius = radiuses[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>];</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>]-&gt;pivot = centers[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>];</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>]-&gt;variance = variance;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>]-&gt;mean_radius = mean_radius;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            node-&gt;childs[<a class="code" href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a>]-&gt;indices = NULL;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            computeClustering(node-&gt;childs[c],indices+start, end-start, branching, level+1);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            start=<a class="code" href="core__c_8h.html#a338bddb6320c8e898e204d6273af2d67">end</a>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keyword">delete</span>[] dcenters.data;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keyword">delete</span>[] centers;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keyword">delete</span>[] <a class="code" href="calib3d_8hpp.html#a46e7cfb7a0edcbf12196e5777a7d6d84">count</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keyword">delete</span>[] belongs_to;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordtype">void</span> findNN(KMeansNodePtr node, ResultSet&lt;DistanceType&gt;&amp; <a class="code" href="core__c_8h.html#a14871c176a686a03035b5f2bbc72a63f">result</a>, <span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec, <span class="keywordtype">int</span>&amp; checks, <span class="keywordtype">int</span> maxChecks,</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                Heap&lt;BranchSt&gt;* heap)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">// Ignore those clusters that are too far away</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> bsq = distance_(vec, node-&gt;pivot, veclen_);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> rsq = node-&gt;radius;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> wsq = result.worstDist();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#aa857b95cc76669c2a9109239ef40a47c">val</a> = bsq-rsq-wsq;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> val2 = val*val-4*rsq*wsq;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="comment">//if (val&gt;0) {</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordflow">if</span> ((val&gt;0)&amp;&amp;(val2&gt;0)) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">if</span> (node-&gt;childs==NULL) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span> (checks&gt;=maxChecks) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <span class="keywordflow">if</span> (result.full()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            checks += node-&gt;size;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;node-&gt;size; ++i) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a> = node-&gt;indices[i];</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a> = distance_(dataset_[index], vec, veclen_);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                result.addPoint(dist, index);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* domain_distances = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[branching_];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordtype">int</span> closest_center = exploreNodeBranches(node, vec, domain_distances, heap);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keyword">delete</span>[] domain_distances;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            findNN(node-&gt;childs[closest_center],result,vec, checks, maxChecks, heap);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordtype">int</span> exploreNodeBranches(KMeansNodePtr node, <span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#afb30bc844faa48275d1c84294956a44b">q</a>, <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* domain_distances, Heap&lt;BranchSt&gt;* heap)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordtype">int</span> best_index = 0;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        domain_distances[best_index] = distance_(q, node-&gt;childs[best_index]-&gt;pivot, veclen_);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            domain_distances[i] = distance_(q, node-&gt;childs[i]-&gt;pivot, veclen_);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">if</span> (domain_distances[i]&lt;domain_distances[best_index]) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                best_index = i;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">//      float* best_center = node-&gt;childs[best_index]-&gt;pivot;</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">if</span> (i != best_index) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                domain_distances[i] -= cb_index_*node-&gt;childs[i]-&gt;variance;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="comment">//              float dist_to_border = getDistanceToBorder(node.childs[i].pivot,best_center,q);</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="comment">//              if (domain_distances[i]&lt;dist_to_border) {</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="comment">//                  domain_distances[i] = dist_to_border;</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <span class="comment">//              }</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                heap-&gt;insert(BranchSt(node-&gt;childs[i],domain_distances[i]));</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">return</span> best_index;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordtype">void</span> findExactNN(KMeansNodePtr node, ResultSet&lt;DistanceType&gt;&amp; result, <span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* vec)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">// Ignore those clusters that are too far away</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> bsq = distance_(vec, node-&gt;pivot, veclen_);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> rsq = node-&gt;radius;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> wsq = result.worstDist();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> val = bsq-rsq-wsq;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> val2 = val*val-4*rsq*wsq;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="comment">//                  if (val&gt;0) {</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="keywordflow">if</span> ((val&gt;0)&amp;&amp;(val2&gt;0)) {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordflow">if</span> (node-&gt;childs==NULL) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;node-&gt;size; ++i) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keywordtype">int</span> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a> = node-&gt;indices[i];</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a> = distance_(dataset_[index], vec, veclen_);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                result.addPoint(dist, index);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordtype">int</span>* sort_indices = <span class="keyword">new</span> <span class="keywordtype">int</span>[branching_];</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            getCenterOrdering(node, vec, sort_indices);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                findExactNN(node-&gt;childs[sort_indices[i]],result,vec);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <span class="keyword">delete</span>[] sort_indices;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">void</span> getCenterOrdering(KMeansNodePtr node, <span class="keyword">const</span> <a class="code" href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">ElementType</a>* q, <span class="keywordtype">int</span>* sort_indices)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* domain_distances = <span class="keyword">new</span> <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>[branching_];</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a> = distance_(q, node-&gt;childs[i]-&gt;pivot, veclen_);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="keywordflow">while</span> (domain_distances[j]&lt;dist &amp;&amp; j&lt;i) j++;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>=i; <a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>&gt;j; --<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                domain_distances[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] = domain_distances[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>-1];</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                sort_indices[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>] = sort_indices[<a class="code" href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a>-1];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            domain_distances[j] = <a class="code" href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            sort_indices[j] = i;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keyword">delete</span>[] domain_distances;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> getDistanceToBorder(<a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a>, <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>, <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>* q)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="code" href="namespacecv.html#aa012757b1a6536a1a3ef813a0aba1c1e">sum</a> = 0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> sum2 = 0;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;veclen_; ++i) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a653819996e713edf9c01a5b564199189">t</a> = c[i]-p[i];</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            sum += t*(q[i]-(c[i]+p[i])/2);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            sum2 += <a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a653819996e713edf9c01a5b564199189">t</a>*<a class="codeRef" doxygen="/Users/andrewfb/Code/cinder_0.8.6_mac/docs/doxygen/cinder.tag:../../../../docs/html/" href="../../../../docs/html/_g_lee_8h.html#a653819996e713edf9c01a5b564199189">t</a>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">return</span> sum*sum/sum2;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordtype">int</span> getMinVarianceClusters(KMeansNodePtr root, KMeansNodePtr* clusters, <span class="keywordtype">int</span> clusters_length, <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a>&amp; varianceValue)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordtype">int</span> clusterCount = 1;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        clusters[0] = root;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> meanVariance = root-&gt;variance*root-&gt;size;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">while</span> (clusterCount&lt;clusters_length) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> minVariance = (std::numeric_limits&lt;DistanceType&gt;::max)();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordtype">int</span> splitIndex = -1;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;clusterCount; ++i) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">if</span> (clusters[i]-&gt;childs != NULL) {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <a class="code" href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">DistanceType</a> variance = meanVariance - clusters[i]-&gt;variance*clusters[i]-&gt;size;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;branching_; ++j) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        variance += clusters[i]-&gt;childs[j]-&gt;variance*clusters[i]-&gt;childs[j]-&gt;size;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    <span class="keywordflow">if</span> (variance&lt;minVariance) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        minVariance = variance;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        splitIndex = i;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                    }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            <span class="keywordflow">if</span> (splitIndex==-1) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">if</span> ( (branching_+clusterCount-1) &gt; clusters_length) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            meanVariance = minVariance;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="comment">// split node</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            KMeansNodePtr toSplit = clusters[splitIndex];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            clusters[splitIndex] = toSplit-&gt;childs[0];</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;branching_; ++i) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                clusters[clusterCount++] = toSplit-&gt;childs[i];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        varianceValue = meanVariance/root-&gt;size;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">return</span> clusterCount;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordtype">int</span> branching_;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordtype">int</span> iterations_;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <a class="code" href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703">flann_centers_init_t</a> centers_init_;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordtype">float</span> cb_index_;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keyword">const</span> Matrix&lt;ElementType&gt; dataset_;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="namespacecvflann.html#a742b4c7076c21012054af74a9ee48289">IndexParams</a> index_params_;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">size_t</span> size_;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordtype">size_t</span> veclen_;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    KMeansNodePtr root_;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordtype">int</span>* indices_;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    Distance distance_;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    PooledAllocator pool_;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordtype">int</span> memoryCounter_;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;};</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;}</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#endif //OPENCV_FLANN_KMEANS_INDEX_H_</span></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a8018b120cc79371b02e58b50f8992634"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a8018b120cc79371b02e58b50f8992634">cvflann::KMeansIndex::buildIndex</a></div><div class="ttdeci">void buildIndex()</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:361</div></div>
<div class="ttc" id="namespacecvflann_html_a4e3e6c98d774ea77fd7f0045c9bc7817"><div class="ttname"><a href="namespacecvflann.html#a4e3e6c98d774ea77fd7f0045c9bc7817">cvflann::flann_algorithm_t</a></div><div class="ttdeci">flann_algorithm_t</div><div class="ttdef"><b>Definition:</b> defines.h:81</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a8aba38be2d90c7dd22eaa710e19ceb83"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a8aba38be2d90c7dd22eaa710e19ceb83">cvflann::KMeansIndex::~KMeansIndex</a></div><div class="ttdeci">virtual ~KMeansIndex()</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:317</div></div>
<div class="ttc" id="namespacecv_html_a2ae54521731aa4bcf7bc5042a2db88bb"><div class="ttname"><a href="namespacecv.html#a2ae54521731aa4bcf7bc5042a2db88bb">cv::sqrt</a></div><div class="ttdeci">CV_EXPORTS_W void sqrt(InputArray src, OutputArray dst)</div><div class="ttdoc">computes square root of each matrix element (dst = src**0.5) </div></div>
<div class="ttc" id="core__c_8h_html_a4e145da43d8cadc65b69ce0c2a2cc76a"><div class="ttname"><a href="core__c_8h.html#a4e145da43d8cadc65b69ce0c2a2cc76a">node</a></div><div class="ttdeci">CvFileNode * node</div><div class="ttdef"><b>Definition:</b> core_c.h:1638</div></div>
<div class="ttc" id="namespacecvflann_html_a6ea20e8aad20212544cb42368c1e5b5f"><div class="ttname"><a href="namespacecvflann.html#a6ea20e8aad20212544cb42368c1e5b5f">cvflann::get_param</a></div><div class="ttdeci">T get_param(const IndexParams &amp;params, std::string name, const T &amp;default_value)</div><div class="ttdef"><b>Definition:</b> params.h:59</div></div>
<div class="ttc" id="classcvflann_1_1_pooled_allocator_html_a6e5510ec11212e0bb1b109b3af09e172"><div class="ttname"><a href="classcvflann_1_1_pooled_allocator.html#a6e5510ec11212e0bb1b109b3af09e172">cvflann::PooledAllocator::usedMemory</a></div><div class="ttdeci">int usedMemory</div><div class="ttdef"><b>Definition:</b> allocator.h:89</div></div>
<div class="ttc" id="_g_lee_8h_html_abc60a79088789bd61297bf5f9ff500d1"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#abc60a79088789bd61297bf5f9ff500d1">level</a></div><div class="ttdeci">GLint level</div><div class="ttdef"><b>Definition:</b> tracking.hpp:88</div></div>
<div class="ttc" id="classcvflann_1_1_matrix_html_a37b28f9c0d87c84cf396dcbe90fae71f"><div class="ttname"><a href="classcvflann_1_1_matrix.html#a37b28f9c0d87c84cf396dcbe90fae71f">cvflann::Matrix::cols</a></div><div class="ttdeci">size_t cols</div><div class="ttdef"><b>Definition:</b> matrix.h:52</div></div>
<div class="ttc" id="_g_lee_8h_html_a13be19455586e95d5a42ed8f054afad2"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a13be19455586e95d5a42ed8f054afad2">start</a></div><div class="ttdeci">GLuint start</div></div>
<div class="ttc" id="namespacecv_html_aad9b72b24146c673236033a113c9ed41"><div class="ttname"><a href="namespacecv.html#aad9b72b24146c673236033a113c9ed41">cv::sort</a></div><div class="ttdeci">CV_EXPORTS_W void sort(InputArray src, OutputArray dst, int flags)</div><div class="ttdoc">sorts independently each matrix row or each matrix column </div></div>
<div class="ttc" id="namespacecvflann_html_a0ad8b53e8b203599f13d67e54c197703a8f42551d6005b25200e6e239d7e1f036"><div class="ttname"><a href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a8f42551d6005b25200e6e239d7e1f036">cvflann::FLANN_CENTERS_GONZALES</a></div><div class="ttdef"><b>Definition:</b> defines.h:108</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html">cvflann::KMeansIndex</a></div><div class="ttdef"><b>Definition:</b> kmeans_index.h:81</div></div>
<div class="ttc" id="calib3d_8hpp_html_a46e7cfb7a0edcbf12196e5777a7d6d84"><div class="ttname"><a href="calib3d_8hpp.html#a46e7cfb7a0edcbf12196e5777a7d6d84">count</a></div><div class="ttdeci">CvSize CvPoint2D32f int count</div><div class="ttdef"><b>Definition:</b> calib3d.hpp:221</div></div>
<div class="ttc" id="classcvflann_1_1_pooled_allocator_html_af69edd6191138a563f9205d1db7bdd18"><div class="ttname"><a href="classcvflann_1_1_pooled_allocator.html#af69edd6191138a563f9205d1db7bdd18">cvflann::PooledAllocator::wastedMemory</a></div><div class="ttdeci">int wastedMemory</div><div class="ttdef"><b>Definition:</b> allocator.h:90</div></div>
<div class="ttc" id="namespacecvflann_html_aa67f0a9c42ad900e10dfd3cf0f1e4355"><div class="ttname"><a href="namespacecvflann.html#aa67f0a9c42ad900e10dfd3cf0f1e4355">cvflann::rand_double</a></div><div class="ttdeci">double rand_double(double high=1.0, double low=0)</div><div class="ttdef"><b>Definition:</b> random.h:61</div></div>
<div class="ttc" id="classcvflann_1_1_result_set_html_a8e29e42b9f3eb9c636f19927f46c8db4"><div class="ttname"><a href="classcvflann_1_1_result_set.html#a8e29e42b9f3eb9c636f19927f46c8db4">cvflann::ResultSet::full</a></div><div class="ttdeci">virtual bool full() const =0</div></div>
<div class="ttc" id="structcvflann_1_1_k_means_index_params_html"><div class="ttname"><a href="structcvflann_1_1_k_means_index_params.html">cvflann::KMeansIndexParams</a></div><div class="ttdef"><b>Definition:</b> kmeans_index.h:56</div></div>
<div class="ttc" id="classcvflann_1_1_pooled_allocator_html_aaf127cab57cd0e0f4d3b335efd8d3a67"><div class="ttname"><a href="classcvflann_1_1_pooled_allocator.html#aaf127cab57cd0e0f4d3b335efd8d3a67">cvflann::PooledAllocator::allocate</a></div><div class="ttdeci">T * allocate(size_t count=1)</div><div class="ttdef"><b>Definition:</b> allocator.h:178</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a2dd49d64f6cdc7751990ee1f1920609e"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a2dd49d64f6cdc7751990ee1f1920609e">cvflann::KMeansIndex::chooseCentersRandom</a></div><div class="ttdeci">void chooseCentersRandom(int k, int *indices, int indices_length, int *centers, int &amp;centers_length)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:108</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_adcf3e940c1ab76474f113c4db65d36c5"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#adcf3e940c1ab76474f113c4db65d36c5">cvflann::KMeansIndex::DistanceType</a></div><div class="ttdeci">Distance::ResultType DistanceType</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:85</div></div>
<div class="ttc" id="_g_lee_8h_html_a57f14e05b1900f16a2da82ade47d0c6d"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a></div><div class="ttdeci">GLuint index</div><div class="ttdef"><b>Definition:</b> core_c.h:986</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a4c388bc8fab9af7ec567e00366ea14f6"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a4c388bc8fab9af7ec567e00366ea14f6">cvflann::KMeansIndex::saveIndex</a></div><div class="ttdeci">void saveIndex(FILE *stream)</div><div class="ttdoc">Saves the index to a stream. </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:378</div></div>
<div class="ttc" id="structcvflann_1_1_k_means_index_params_html_a90583aa43cad96f6c7cecb3febe8213b"><div class="ttname"><a href="structcvflann_1_1_k_means_index_params.html#a90583aa43cad96f6c7cecb3febe8213b">cvflann::KMeansIndexParams::KMeansIndexParams</a></div><div class="ttdeci">KMeansIndexParams(int branching=32, int iterations=11, flann_centers_init_t centers_init=FLANN_CENTERS_RANDOM, float cb_index=0.2)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:58</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_accb5cd8cd1aec9b55420471537ee6423"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#accb5cd8cd1aec9b55420471537ee6423">cvflann::KMeansIndex::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:330</div></div>
<div class="ttc" id="classcvflann_1_1_f_l_a_n_n_exception_html"><div class="ttname"><a href="classcvflann_1_1_f_l_a_n_n_exception.html">cvflann::FLANNException</a></div><div class="ttdef"><b>Definition:</b> general.h:41</div></div>
<div class="ttc" id="legacy_8hpp_html_a6f364afbe132c4ecfea48bde1b0618ba"><div class="ttname"><a href="legacy_8hpp.html#a6f364afbe132c4ecfea48bde1b0618ba">d</a></div><div class="ttdeci">int d</div><div class="ttdef"><b>Definition:</b> legacy.hpp:3064</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a02bf5e31ac3996251fea5e2de6bd3fea"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a02bf5e31ac3996251fea5e2de6bd3fea">cvflann::KMeansIndex::chooseCentersKMeanspp</a></div><div class="ttdeci">void chooseCentersKMeanspp(int k, int *indices, int indices_length, int *centers, int &amp;centers_length)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:200</div></div>
<div class="ttc" id="core__c_8h_html_a54709f3b06b33b66763f1613cc7fb571"><div class="ttname"><a href="core__c_8h.html#a54709f3b06b33b66763f1613cc7fb571">r</a></div><div class="ttdeci">CvRect r</div><div class="ttdef"><b>Definition:</b> core_c.h:1282</div></div>
<div class="ttc" id="core__c_8h_html_a3f007d4bba0b0e0a4cbcb681f97f241c"><div class="ttname"><a href="core__c_8h.html#a3f007d4bba0b0e0a4cbcb681f97f241c">center</a></div><div class="ttdeci">CvPoint center</div><div class="ttdef"><b>Definition:</b> core_c.h:1290</div></div>
<div class="ttc" id="classcvflann_1_1_matrix_html"><div class="ttname"><a href="classcvflann_1_1_matrix.html">cvflann::Matrix&lt; ElementType &gt;</a></div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a95475eb6c639b87fa5e07812d6f4058a"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a95475eb6c639b87fa5e07812d6f4058a">cvflann::KMeansIndex::usedMemory</a></div><div class="ttdeci">int usedMemory() const </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:353</div></div>
<div class="ttc" id="namespacecv_html_aa012757b1a6536a1a3ef813a0aba1c1e"><div class="ttname"><a href="namespacecv.html#aa012757b1a6536a1a3ef813a0aba1c1e">cv::sum</a></div><div class="ttdeci">OutputArray sum</div><div class="ttdef"><b>Definition:</b> imgproc.hpp:620</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a1e51703a5f49deda70a3eb1ce755ce45"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a1e51703a5f49deda70a3eb1ce755ce45">cvflann::KMeansIndex::getParameters</a></div><div class="ttdeci">IndexParams getParameters() const </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:484</div></div>
<div class="ttc" id="namespacecvflann_html_a4e3e6c98d774ea77fd7f0045c9bc7817a8f59fc67e6deef84edfaf55506bb8466"><div class="ttname"><a href="namespacecvflann.html#a4e3e6c98d774ea77fd7f0045c9bc7817a8f59fc67e6deef84edfaf55506bb8466">cvflann::FLANN_INDEX_KMEANS</a></div><div class="ttdef"><b>Definition:</b> defines.h:85</div></div>
<div class="ttc" id="structcvflann_1_1_branch_struct_html_aec910979d940fef80651b196a294ad70"><div class="ttname"><a href="structcvflann_1_1_branch_struct.html#aec910979d940fef80651b196a294ad70">cvflann::BranchStruct::node</a></div><div class="ttdeci">T node</div><div class="ttdef"><b>Definition:</b> result_set.h:52</div></div>
<div class="ttc" id="core__c_8h_html_a14871c176a686a03035b5f2bbc72a63f"><div class="ttname"><a href="core__c_8h.html#a14871c176a686a03035b5f2bbc72a63f">result</a></div><div class="ttdeci">const CvArr const CvArr CvArr * result</div><div class="ttdef"><b>Definition:</b> core_c.h:805</div></div>
<div class="ttc" id="highgui__c_8h_html_ad1f9461adaad33556b3a01c7f2c6ceab"><div class="ttname"><a href="highgui__c_8h.html#ad1f9461adaad33556b3a01c7f2c6ceab">void</a></div><div class="ttdeci">typedef void(CV_CDECL *CvMouseCallback)(int event</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a8d2472fca09e17b351ed52b90e0d3b25"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a8d2472fca09e17b351ed52b90e0d3b25">cvflann::KMeansIndex::operator=</a></div><div class="ttdeci">KMeansIndex &amp; operator=(const KMeansIndex &amp;)</div></div>
<div class="ttc" id="structcvflann_1_1_search_params_html"><div class="ttname"><a href="structcvflann_1_1_search_params.html">cvflann::SearchParams</a></div><div class="ttdef"><b>Definition:</b> params.h:44</div></div>
<div class="ttc" id="core__c_8h_html_a45314566a84a31f43e6435d1eb24d4ec"><div class="ttname"><a href="core__c_8h.html#a45314566a84a31f43e6435d1eb24d4ec">start</a></div><div class="ttdeci">double start</div><div class="ttdef"><b>Definition:</b> core_c.h:774</div></div>
<div class="ttc" id="heap_8h_html"><div class="ttname"><a href="heap_8h.html">heap.h</a></div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a2e666baa48e5094e755c0ccdeb908b55"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a2e666baa48e5094e755c0ccdeb908b55">cvflann::KMeansIndex::findNeighbors</a></div><div class="ttdeci">void findNeighbors(ResultSet&lt; DistanceType &gt; &amp;result, const ElementType *vec, const SearchParams &amp;searchParams)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:425</div></div>
<div class="ttc" id="_g_lee_8h_html_aa857b95cc76669c2a9109239ef40a47c"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#aa857b95cc76669c2a9109239ef40a47c">val</a></div><div class="ttdeci">GLuint GLfloat * val</div></div>
<div class="ttc" id="result__set_8h_html"><div class="ttname"><a href="result__set_8h.html">result_set.h</a></div></div>
<div class="ttc" id="legacy_8hpp_html_af2af72053e0d7a7150c50c993d1cb2b3"><div class="ttname"><a href="legacy_8hpp.html#af2af72053e0d7a7150c50c993d1cb2b3">level</a></div><div class="ttdeci">IplImage CvMemStorage CvSeq int level</div><div class="ttdef"><b>Definition:</b> legacy.hpp:2917</div></div>
<div class="ttc" id="_g_lee_8h_html_adbd1b09d60fa0a569e6873aa161d44c7"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#adbd1b09d60fa0a569e6873aa161d44c7">indices</a></div><div class="ttdeci">GLuint GLuint GLsizei GLenum const GLvoid * indices</div><div class="ttdef"><b>Definition:</b> legacy.hpp:3084</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a773a603be17320c0d106662548407336"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a773a603be17320c0d106662548407336">cvflann::KMeansIndex::getClusterCenters</a></div><div class="ttdeci">int getClusterCenters(Matrix&lt; DistanceType &gt; &amp;centers)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:459</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_ac65e5ca1bc0c0e1a4663438eff141861"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#ac65e5ca1bc0c0e1a4663438eff141861">cvflann::KMeansIndex::set_cb_index</a></div><div class="ttdeci">void set_cb_index(float index)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:344</div></div>
<div class="ttc" id="_g_lee_8h_html_afb30bc844faa48275d1c84294956a44b"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#afb30bc844faa48275d1c84294956a44b">q</a></div><div class="ttdeci">GLdouble GLdouble GLdouble GLdouble q</div></div>
<div class="ttc" id="namespacecv_html_ab95fdcad3fb0246321e2af231d24d5a9"><div class="ttname"><a href="namespacecv.html#ab95fdcad3fb0246321e2af231d24d5a9">cv::min</a></div><div class="ttdeci">CV_EXPORTS_W void min(InputArray src1, InputArray src2, OutputArray dst)</div><div class="ttdoc">computes per-element minimum of two arrays (dst = min(src1, src2)) </div></div>
<div class="ttc" id="core__c_8h_html_a750b5d744c39a06bfb13e6eb010e35d0"><div class="ttname"><a href="core__c_8h.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> core_c.h:309</div></div>
<div class="ttc" id="saving_8h_html"><div class="ttname"><a href="saving_8h.html">saving.h</a></div></div>
<div class="ttc" id="legacy_8hpp_html_a7be9b6436e5ea72ff5d5a66779b4bd38"><div class="ttname"><a href="legacy_8hpp.html#a7be9b6436e5ea72ff5d5a66779b4bd38">k</a></div><div class="ttdeci">const CvMat CvMat CvMat int k</div><div class="ttdef"><b>Definition:</b> legacy.hpp:3052</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_ab1d2d857e2ee7660d24e563c4c11dab1"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#ab1d2d857e2ee7660d24e563c4c11dab1">cvflann::KMeansIndex::getType</a></div><div class="ttdeci">flann_algorithm_t getType() const </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:263</div></div>
<div class="ttc" id="_g_lee_8h_html_a9274fa62feb8371797c4c0312446e333"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a9274fa62feb8371797c4c0312446e333">count</a></div><div class="ttdeci">GLuint GLuint GLsizei count</div><div class="ttdef"><b>Definition:</b> core_c.h:973</div></div>
<div class="ttc" id="_g_lee_8h_html_a830e6eb5d1b77f7226a78592ba9d2613"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a830e6eb5d1b77f7226a78592ba9d2613">n</a></div><div class="ttdeci">GLenum GLsizei n</div></div>
<div class="ttc" id="classcvflann_1_1_unique_random_html"><div class="ttname"><a href="classcvflann_1_1_unique_random.html">cvflann::UniqueRandom</a></div><div class="ttdef"><b>Definition:</b> random.h:81</div></div>
<div class="ttc" id="legacy_8hpp_html_a1971420173e06f45845eed2ab4e3d5d0"><div class="ttname"><a href="legacy_8hpp.html#a1971420173e06f45845eed2ab4e3d5d0">c</a></div><div class="ttdeci">CvPoint2D32f float float float c</div><div class="ttdef"><b>Definition:</b> legacy.hpp:578</div></div>
<div class="ttc" id="namespacecvflann_html_ac76450e068ff8d95e2e5736141201faf"><div class="ttname"><a href="namespacecvflann.html#ac76450e068ff8d95e2e5736141201faf">cvflann::load_value</a></div><div class="ttdeci">void load_value(FILE *stream, T &amp;value, size_t count=1)</div><div class="ttdef"><b>Definition:</b> saving.h:147</div></div>
<div class="ttc" id="tracking_8hpp_html_a17372ac3c8ba01bc6cfc265b2824992e"><div class="ttname"><a href="tracking_8hpp.html#a17372ac3c8ba01bc6cfc265b2824992e">iterations</a></div><div class="ttdeci">const CvArr CvArr double int int int iterations</div><div class="ttdef"><b>Definition:</b> tracking.hpp:102</div></div>
<div class="ttc" id="namespacecvflann_html_a0ad8b53e8b203599f13d67e54c197703"><div class="ttname"><a href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703">cvflann::flann_centers_init_t</a></div><div class="ttdeci">flann_centers_init_t</div><div class="ttdef"><b>Definition:</b> defines.h:105</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a224fbbe5fdc60db9374ddbf499b0e9d3"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a224fbbe5fdc60db9374ddbf499b0e9d3">cvflann::KMeansIndex::chooseCentersGonzales</a></div><div class="ttdeci">void chooseCentersGonzales(int k, int *indices, int indices_length, int *centers, int &amp;centers_length)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:149</div></div>
<div class="ttc" id="legacy_8hpp_html_a51ee427d6109367fc5bc252655997324"><div class="ttname"><a href="legacy_8hpp.html#a51ee427d6109367fc5bc252655997324">indices</a></div><div class="ttdeci">const CvMat CvMat * indices</div><div class="ttdef"><b>Definition:</b> legacy.hpp:3052</div></div>
<div class="ttc" id="classcvflann_1_1_result_set_html"><div class="ttname"><a href="classcvflann_1_1_result_set.html">cvflann::ResultSet</a></div><div class="ttdef"><b>Definition:</b> result_set.h:66</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_ad3c60e35d2f9face152ef9a8a303493a"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#ad3c60e35d2f9face152ef9a8a303493a">cvflann::KMeansIndex::veclen</a></div><div class="ttdeci">size_t veclen() const </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:338</div></div>
<div class="ttc" id="core__c_8h_html_ad090d0faa53f44e0377c8d63dab3fa20"><div class="ttname"><a href="core__c_8h.html#ad090d0faa53f44e0377c8d63dab3fa20">mean</a></div><div class="ttdeci">CvArr * mean</div><div class="ttdef"><b>Definition:</b> core_c.h:802</div></div>
<div class="ttc" id="_g_lee_8h_html_a432111147038972f06e049e18a837002"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a432111147038972f06e049e18a837002">end</a></div><div class="ttdeci">GLuint GLuint end</div></div>
<div class="ttc" id="namespacecvflann_html_a742b4c7076c21012054af74a9ee48289"><div class="ttname"><a href="namespacecvflann.html#a742b4c7076c21012054af74a9ee48289">cvflann::IndexParams</a></div><div class="ttdeci">std::map&lt; std::string, any &gt; IndexParams</div><div class="ttdef"><b>Definition:</b> params.h:42</div></div>
<div class="ttc" id="classcvflann_1_1_unique_random_html_a95eb32308d0a5a2d99a03fe23d809c1f"><div class="ttname"><a href="classcvflann_1_1_unique_random.html#a95eb32308d0a5a2d99a03fe23d809c1f">cvflann::UniqueRandom::next</a></div><div class="ttdeci">int next()</div><div class="ttdef"><b>Definition:</b> random.h:120</div></div>
<div class="ttc" id="_g_lee_8h_html_aa5367c14d90f462230c2611b81b41d23"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a></div><div class="ttdeci">GLfloat GLfloat p</div></div>
<div class="ttc" id="_g_lee_8h_html_ae2ae747114928314b8d60d4a3c5c6f77"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#ae2ae747114928314b8d60d4a3c5c6f77">params</a></div><div class="ttdeci">GLenum const GLfloat * params</div><div class="ttdef"><b>Definition:</b> compat.hpp:688</div></div>
<div class="ttc" id="_g_lee_8h_html_a1f2d7f8147412c43ba2303a56f97ee73"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a></div><div class="ttdeci">const GLubyte * c</div><div class="ttdef"><b>Definition:</b> legacy.hpp:633</div></div>
<div class="ttc" id="dist_8h_html"><div class="ttname"><a href="dist_8h.html">dist.h</a></div></div>
<div class="ttc" id="namespacecvflann_html_a07490d20628e87c4c1cc7438d22b0b32a117f0363bf05d8ee327d795e0ff1d174"><div class="ttname"><a href="namespacecvflann.html#a07490d20628e87c4c1cc7438d22b0b32a117f0363bf05d8ee327d795e0ff1d174">cvflann::FLANN_CHECKS_UNLIMITED</a></div><div class="ttdef"><b>Definition:</b> defines.h:170</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a09b9ff9e5a1686adc4a5e6cc8a765768"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a09b9ff9e5a1686adc4a5e6cc8a765768">cvflann::KMeansIndex::centersAlgFunction</a></div><div class="ttdeci">void(KMeansIndex::* centersAlgFunction)(int, int *, int, int *, int &amp;)</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:89</div></div>
<div class="ttc" id="general_8h_html"><div class="ttname"><a href="general_8h.html">general.h</a></div></div>
<div class="ttc" id="logger_8h_html"><div class="ttname"><a href="logger_8h.html">logger.h</a></div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a11e0ff42576490042f640c2c382999d0"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a11e0ff42576490042f640c2c382999d0">cvflann::KMeansIndex::loadIndex</a></div><div class="ttdeci">void loadIndex(FILE *stream)</div><div class="ttdoc">Loads the index from a stream. </div><div class="ttdef"><b>Definition:</b> kmeans_index.h:390</div></div>
<div class="ttc" id="allocator_8h_html"><div class="ttname"><a href="allocator_8h.html">allocator.h</a></div></div>
<div class="ttc" id="classcvflann_1_1_n_n_index_html"><div class="ttname"><a href="classcvflann_1_1_n_n_index.html">cvflann::NNIndex</a></div><div class="ttdef"><b>Definition:</b> nn_index.h:48</div></div>
<div class="ttc" id="legacy_8hpp_html_a76f11d9a0a47b94f72c2d0e77fb32240"><div class="ttname"><a href="legacy_8hpp.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> legacy.hpp:3070</div></div>
<div class="ttc" id="classcvflann_1_1_matrix_html_aff6ee6abf050b1848fca59654c5669bc"><div class="ttname"><a href="classcvflann_1_1_matrix.html#aff6ee6abf050b1848fca59654c5669bc">cvflann::Matrix::rows</a></div><div class="ttdeci">size_t rows</div><div class="ttdef"><b>Definition:</b> matrix.h:51</div></div>
<div class="ttc" id="namespacecv_1_1gpu_1_1device_html_ae514b01a13bdbec7aff2754bac45ddda"><div class="ttname"><a href="namespacecv_1_1gpu_1_1device.html#ae514b01a13bdbec7aff2754bac45ddda">cv::gpu::device::int</a></div><div class="ttdeci">::max::max int</div><div class="ttdef"><b>Definition:</b> functional.hpp:324</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_af02aa808b786b448cc5aaac95104d0d7"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#af02aa808b786b448cc5aaac95104d0d7">cvflann::KMeansIndex::chooseCenters</a></div><div class="ttdeci">centersAlgFunction chooseCenters</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:94</div></div>
<div class="ttc" id="random_8h_html"><div class="ttname"><a href="random_8h.html">random.h</a></div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_ae4bea160d9e9d70f0f8177be8e0d1f0e"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#ae4bea160d9e9d70f0f8177be8e0d1f0e">cvflann::KMeansIndex::KMeansIndex</a></div><div class="ttdeci">KMeansIndex(const Matrix&lt; ElementType &gt; &amp;inputData, const IndexParams &amp;params=KMeansIndexParams(), Distance d=Distance())</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:275</div></div>
<div class="ttc" id="core__c_8h_html_a338bddb6320c8e898e204d6273af2d67"><div class="ttname"><a href="core__c_8h.html#a338bddb6320c8e898e204d6273af2d67">end</a></div><div class="ttdeci">double double end</div><div class="ttdef"><b>Definition:</b> core_c.h:774</div></div>
<div class="ttc" id="classcvflann_1_1_heap_html"><div class="ttname"><a href="classcvflann_1_1_heap.html">cvflann::Heap</a></div><div class="ttdef"><b>Definition:</b> heap.h:48</div></div>
<div class="ttc" id="namespacecv_html_aee66fd35ceb08e5e93177b123481a25e"><div class="ttname"><a href="namespacecv.html#aee66fd35ceb08e5e93177b123481a25e">cv::swap</a></div><div class="ttdeci">CV_EXPORTS void swap(Mat &amp;a, Mat &amp;b)</div><div class="ttdoc">swaps two matrices </div></div>
<div class="ttc" id="namespacecvflann_html_a0ad8b53e8b203599f13d67e54c197703a2cec6d6a56fac53c140b2f8f28a14aef"><div class="ttname"><a href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a2cec6d6a56fac53c140b2f8f28a14aef">cvflann::FLANN_CENTERS_RANDOM</a></div><div class="ttdef"><b>Definition:</b> defines.h:107</div></div>
<div class="ttc" id="_g_lee_8h_html_a653819996e713edf9c01a5b564199189"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#a653819996e713edf9c01a5b564199189">t</a></div><div class="ttdeci">GLdouble GLdouble t</div></div>
<div class="ttc" id="namespacecvflann_html_af21cc31d343e3e1132f34e11094d49a1"><div class="ttname"><a href="namespacecvflann.html#af21cc31d343e3e1132f34e11094d49a1">cvflann::save_value</a></div><div class="ttdeci">void save_value(FILE *stream, const T &amp;value, size_t count=1)</div><div class="ttdef"><b>Definition:</b> saving.h:126</div></div>
<div class="ttc" id="_g_lee_8h_html_ad585a1393cfa368fa9dc3d8ebff640d5"><div class="ttname"><a href="../../../../docs/html/_g_lee_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a></div><div class="ttdeci">GLdouble s</div></div>
<div class="ttc" id="nn__index_8h_html"><div class="ttname"><a href="nn__index_8h.html">nn_index.h</a></div></div>
<div class="ttc" id="core__c_8h_html_a7bea932e1cd0c79d103a7870a1921a4e"><div class="ttname"><a href="core__c_8h.html#a7bea932e1cd0c79d103a7870a1921a4e">radius</a></div><div class="ttdeci">CvPoint int radius</div><div class="ttdef"><b>Definition:</b> core_c.h:1290</div></div>
<div class="ttc" id="classcvflann_1_1_k_means_index_html_a2a28d6535e3e452320f97417f6c127ef"><div class="ttname"><a href="classcvflann_1_1_k_means_index.html#a2a28d6535e3e452320f97417f6c127ef">cvflann::KMeansIndex::ElementType</a></div><div class="ttdeci">Distance::ElementType ElementType</div><div class="ttdef"><b>Definition:</b> kmeans_index.h:84</div></div>
<div class="ttc" id="classcvflann_1_1_heap_html_a6c6d2fd6b7522e13049389ab4ae0e0ab"><div class="ttname"><a href="classcvflann_1_1_heap.html#a6c6d2fd6b7522e13049389ab4ae0e0ab">cvflann::Heap::popMin</a></div><div class="ttdeci">bool popMin(T &amp;value)</div><div class="ttdef"><b>Definition:</b> heap.h:147</div></div>
<div class="ttc" id="namespacecvflann_html_a95bce8b3d90ee54a8a4454bdc74ead3b"><div class="ttname"><a href="namespacecvflann.html#a95bce8b3d90ee54a8a4454bdc74ead3b">cvflann::rand_int</a></div><div class="ttdeci">int rand_int(int high=RAND_MAX, int low=0)</div><div class="ttdef"><b>Definition:</b> random.h:72</div></div>
<div class="ttc" id="namespacecvflann_html_a0ad8b53e8b203599f13d67e54c197703a99f2e3471f856cda026b4d922275e60b"><div class="ttname"><a href="namespacecvflann.html#a0ad8b53e8b203599f13d67e54c197703a99f2e3471f856cda026b4d922275e60b">cvflann::FLANN_CENTERS_KMEANSPP</a></div><div class="ttdef"><b>Definition:</b> defines.h:109</div></div>
<div class="ttc" id="legacy_8hpp_html_ae895c2003a87eda49126845b7ac3688e"><div class="ttname"><a href="legacy_8hpp.html#ae895c2003a87eda49126845b7ac3688e">dist</a></div><div class="ttdeci">CvPoint3D64f double * dist</div><div class="ttdef"><b>Definition:</b> legacy.hpp:556</div></div>
<div class="ttc" id="structcvflann_1_1_branch_struct_html"><div class="ttname"><a href="structcvflann_1_1_branch_struct.html">cvflann::BranchStruct</a></div><div class="ttdef"><b>Definition:</b> result_set.h:50</div></div>
<div class="ttc" id="namespacecv_1_1gpu_1_1device_html_ac2a9c7bbc0733fc5db3e91e189bc16f6"><div class="ttname"><a href="namespacecv_1_1gpu_1_1device.html#ac2a9c7bbc0733fc5db3e91e189bc16f6">cv::gpu::device::double</a></div><div class="ttdeci">short float uchar uchar uchar uchar uchar ushort int uchar ushort int float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float float int int int float int int int float int CV_CUDEV_IMPLEMENT_VEC_BINARY_OP char CV_CUDEV_IMPLEMENT_VEC_BINARY_OP ushort CV_CUDEV_IMPLEMENT_VEC_BINARY_OP short CV_CUDEV_IMPLEMENT_VEC_BINARY_OP int CV_CUDEV_IMPLEMENT_VEC_BINARY_OP uint CV_CUDEV_IMPLEMENT_VEC_BINARY_OP float CV_CUDEV_IMPLEMENT_VEC_BINARY_OP double int int uint double</div><div class="ttdef"><b>Definition:</b> vec_math.hpp:432</div></div>
</div><!-- fragment --></div><!-- contents -->
	<div class="footer">
		<p> </p>
	</div>
</div>	
</body>
</html>